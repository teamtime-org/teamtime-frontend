<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Gauge Chart</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .gauge-container {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            padding: 24px;
            margin: 20px auto;
            max-width: 600px;
        }
        .title {
            font-size: 18px;
            font-weight: bold;
            color: #1f2937;
            text-align: center;
            margin-bottom: 20px;
        }
        .controls {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        .control-group {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }
        input[type="range"] {
            width: 100px;
        }
        button {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
        }
        button:hover {
            background: #2563eb;
        }
    </style>
</head>
<body>
    <div class="gauge-container">
        <div class="title">Test del Medidor de Carga Laboral</div>
        
        <div class="controls">
            <div class="control-group">
                <label>Porcentaje:</label>
                <input type="range" id="percentage" min="0" max="200" value="66" oninput="updateGauge()">
                <span id="percentageValue">66%</span>
            </div>
            <div class="control-group">
                <label>Horas PMO:</label>
                <input type="number" id="horasPMO" value="25" min="0" max="200" oninput="updateGauge()">
            </div>
            <div class="control-group">
                <label>Horas Cliente:</label>
                <input type="number" id="horasCliente" value="39" min="0" max="200" oninput="updateGauge()">
            </div>
            <div class="control-group">
                <label>Horas Referencia:</label>
                <input type="number" id="horasReferencia" value="96" min="1" max="200" oninput="updateGauge()">
            </div>
        </div>
        
        <div class="controls">
            <button onclick="setPreset(30, 10, 20, 48)">Baja Carga (30%)</button>
            <button onclick="setPreset(95, 25, 39, 67)">Ideal (95%)</button>
            <button onclick="setPreset(150, 40, 64, 70)">Sobrecarga (150%)</button>
        </div>
        
        <div id="gaugeContainer"></div>
    </div>

    <script>
        // Simulación del componente GaugeChart usando Canvas
        function createGauge(container, options) {
            const { value, horasPMO, horasCliente, horasReferencia } = options;
            
            container.innerHTML = '';
            
            // Crear estructura HTML
            const wrapper = document.createElement('div');
            wrapper.className = 'flex flex-col items-center';
            
            const title = document.createElement('h3');
            title.textContent = 'PORCENTAJE DE CARGA LABORAL';
            title.style.cssText = 'font-size: 16px; font-weight: bold; color: #1f2937; margin-bottom: 16px; text-align: center;';
            
            const canvasContainer = document.createElement('div');
            canvasContainer.style.position = 'relative';
            
            const canvas = document.createElement('canvas');
            canvas.width = 300;
            canvas.height = 200;
            canvas.style.maxWidth = '100%';
            canvas.style.height = 'auto';
            
            const valueDisplay = document.createElement('div');
            valueDisplay.style.cssText = 'position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%); text-align: center;';
            
            const percentage = document.createElement('div');
            percentage.textContent = value.toFixed(1) + '%';
            percentage.style.cssText = 'font-size: 24px; font-weight: bold; color: ' + getStatusColor(value) + ';';
            
            const status = document.createElement('div');
            status.textContent = getStatusText(value);
            status.style.cssText = 'font-size: 14px; font-weight: 500; margin-top: 4px; color: ' + getStatusColor(value) + ';';
            
            valueDisplay.appendChild(percentage);
            valueDisplay.appendChild(status);
            canvasContainer.appendChild(canvas);
            canvasContainer.appendChild(valueDisplay);
            
            wrapper.appendChild(title);
            wrapper.appendChild(canvasContainer);
            
            // Crear resumen de horas
            if (horasReferencia > 0) {
                const summary = document.createElement('div');
                summary.style.cssText = 'margin-top: 16px; text-align: center; background-color: #f9fafb; border-radius: 8px; padding: 12px; width: 100%; max-width: 384px;';
                
                const summaryContent = `
                    <div style="font-size: 12px; color: #6b7280; margin-bottom: 4px;">
                        <strong>Horas PMO:</strong> ${horasPMO}h (${((horasPMO / horasReferencia) * 100).toFixed(1)}%)
                    </div>
                    <div style="font-size: 12px; color: #6b7280; margin-bottom: 4px;">
                        <strong>Horas Cliente:</strong> ${horasCliente}h (${((horasCliente / horasReferencia) * 100).toFixed(1)}%)
                    </div>
                    <div style="font-size: 12px; font-weight: bold; border-top: 1px solid #e5e7eb; padding-top: 4px;">
                        <strong>Total:</strong> ${(horasPMO + horasCliente).toFixed(1)}h (${value.toFixed(1)}%)
                    </div>
                `;
                summary.innerHTML = summaryContent;
                wrapper.appendChild(summary);
            }
            
            container.appendChild(wrapper);
            
            // Dibujar el gauge
            drawGauge(canvas, value);
        }
        
        function drawGauge(canvas, value) {
            const ctx = canvas.getContext('2d');
            const centerX = canvas.width / 2;
            const centerY = canvas.height * 0.85;
            const radius = Math.min(canvas.width, canvas.height * 2) * 0.35;
            
            // Clamp value
            const clampedValue = Math.max(10, Math.min(180, value));
            
            // Clear canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Draw background arc
            ctx.strokeStyle = '#e5e7eb';
            ctx.lineWidth = 20;
            ctx.beginPath();
            ctx.arc(centerX, centerY, radius, Math.PI, 2 * Math.PI);
            ctx.stroke();
            
            // Draw colored zones
            const zones = [
                { start: 10, end: 50, color: '#ef4444' },
                { start: 50, end: 60, color: '#f59e0b' },
                { start: 60, end: 80, color: '#f59e0b' },
                { start: 80, end: 90, color: '#84cc16' },
                { start: 90, end: 100, color: '#10b981' },
                { start: 100, end: 110, color: '#84cc16' },
                { start: 110, end: 120, color: '#f59e0b' },
                { start: 120, end: 130, color: '#f59e0b' },
                { start: 130, end: 180, color: '#ef4444' }
            ];
            
            zones.forEach(zone => {
                const startAngle = Math.PI + (zone.start - 10) / 170 * Math.PI;
                const endAngle = Math.PI + (zone.end - 10) / 170 * Math.PI;
                
                ctx.strokeStyle = zone.color;
                ctx.lineWidth = 20;
                ctx.beginPath();
                ctx.arc(centerX, centerY, radius, startAngle, endAngle);
                ctx.stroke();
            });
            
            // Draw scale marks
            ctx.strokeStyle = '#374151';
            ctx.fillStyle = '#374151';
            ctx.font = '11px Arial';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            
            for (let i = 10; i <= 180; i += 10) {
                const angle = Math.PI + (i - 10) / 170 * Math.PI;
                const cos = Math.cos(angle);
                const sin = Math.sin(angle);
                
                const tickLength = i % 20 === 0 ? 15 : 8;
                const outerRadius = radius + 25;
                const innerRadius = outerRadius - tickLength;
                
                ctx.lineWidth = i % 20 === 0 ? 2 : 1;
                ctx.beginPath();
                ctx.moveTo(centerX + cos * innerRadius, centerY + sin * innerRadius);
                ctx.lineTo(centerX + cos * outerRadius, centerY + sin * outerRadius);
                ctx.stroke();
                
                if (i % 20 === 0) {
                    const textRadius = outerRadius + 15;
                    const textX = centerX + cos * textRadius;
                    const textY = centerY + sin * textRadius;
                    
                    ctx.fillStyle = '#374151';
                    ctx.font = 'bold 10px Arial';
                    ctx.fillText(i + '%', textX, textY);
                }
            }
            
            // Draw needle
            const needleAngle = Math.PI + (clampedValue - 10) / 170 * Math.PI;
            const needleCos = Math.cos(needleAngle);
            const needleSin = Math.sin(needleAngle);
            
            // Needle base
            ctx.fillStyle = '#374151';
            ctx.beginPath();
            ctx.arc(centerX, centerY, 8, 0, 2 * Math.PI);
            ctx.fill();
            
            // Needle triangle
            const needleLength = radius - 10;
            ctx.fillStyle = '#dc2626';
            ctx.beginPath();
            ctx.moveTo(centerX + needleCos * needleLength, centerY + needleSin * needleLength);
            ctx.lineTo(centerX + needleCos * 15 - needleSin * 4, centerY + needleSin * 15 + needleCos * 4);
            ctx.lineTo(centerX + needleCos * 15 + needleSin * 4, centerY + needleSin * 15 - needleCos * 4);
            ctx.closePath();
            ctx.fill();
        }
        
        function getStatusColor(percentage) {
            if (percentage >= 90 && percentage <= 100) return '#059669';
            if ((percentage >= 60 && percentage < 90) || (percentage > 100 && percentage <= 120)) return '#d97706';
            return '#dc2626';
        }
        
        function getStatusText(percentage) {
            if (percentage >= 90 && percentage <= 100) return 'Carga en rango ideal';
            if ((percentage >= 60 && percentage < 90) || (percentage > 100 && percentage <= 120)) return 'Atención: zona de alerta';
            return 'Riesgo: ajustar asignación';
        }
        
        function updateGauge() {
            const percentage = parseFloat(document.getElementById('percentage').value);
            const horasPMO = parseFloat(document.getElementById('horasPMO').value) || 0;
            const horasCliente = parseFloat(document.getElementById('horasCliente').value) || 0;
            const horasReferencia = parseFloat(document.getElementById('horasReferencia').value) || 1;
            
            document.getElementById('percentageValue').textContent = percentage + '%';
            
            createGauge(document.getElementById('gaugeContainer'), {
                value: percentage,
                horasPMO: horasPMO,
                horasCliente: horasCliente,
                horasReferencia: horasReferencia
            });
        }
        
        function setPreset(percentage, pmo, cliente, referencia) {
            document.getElementById('percentage').value = percentage;
            document.getElementById('horasPMO').value = pmo;
            document.getElementById('horasCliente').value = cliente;
            document.getElementById('horasReferencia').value = referencia;
            updateGauge();
        }
        
        // Inicializar
        updateGauge();
    </script>
</body>
</html>